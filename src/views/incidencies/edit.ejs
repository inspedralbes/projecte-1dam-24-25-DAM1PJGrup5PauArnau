<%- include('../partials/header', { title: 'Editar Incidència' }) %>

<h1>Editar Incidència</h1>

<form action="/incidencies/<%= incidencia.id %>/update" method="POST">
  <div class="form-group mb-3">
    <label for="descripcio">Descripció:</label>
    <textarea name="descripcio" id="descripcio" class="form-control"><%= incidencia.descripcio %></textarea>
  </div>

  <div class="form-group mb-3">
    <label for="prioritat">Prioritat:</label>
    <select name="prioritat" id="prioritat" class="form-select">
      <option value="Baixa" <%= incidencia.prioritat === 'Baixa' ? 'selected' : '' %>>Baixa</option>
      <option value="Mitjana" <%= incidencia.prioritat === 'Mitjana' ? 'selected' : '' %>>Mitjana</option>
      <option value="Alta" <%= incidencia.prioritat === 'Alta' ? 'selected' : '' %>>Alta</option>
    </select>
  </div>

  <button type="submit" class="btn btn-primary">Guardar</button>
</form>

<h2>Llista d'Incidències</h2>
<table class="table table-bordered" border="1">
  <thead>
    <tr>
      <th>ID</th>
      <th>Descripció</th>
      <th>Departament</th>
      <th>Prioritat</th>
    </tr>
  </thead>
  <tbody>
    <% incidencies.forEach(inc => { %>
      <tr>
        <td><%= inc.id %></td>
        <td><%= inc.descripcio %></td>
        <td><%= inc.Departament ? inc.Departament.nom : 'Sense departament' %></td>
        <td><%= inc.prioritat %></td>
      </tr>
    <% }) %>
  </tbody>
</table>

<%- include('../partials/footer') %>